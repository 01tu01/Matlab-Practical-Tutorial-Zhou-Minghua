# 第6章 插值与拟合

1. 设有函数$y=f(x)=\sin x$的数值表如下：

   | $x$  | $0$  | $\pi/4$ | $\pi/2$ | $3\pi/4$ | $\pi$ | $5\pi/4$ | $3\pi/2$ | $7\pi/4$ | $2\pi$ |
   | :--: | :--: | :-----: | :-----: | :------: | :---: | :------: | :------: | :------: | :----: |
   | $y$  | $0$  | $0.707$ |   $1$   | $0.707$  |  $0$  | $-0.707$ |   $-1$   | $-0.707$ |  $0$   |

   (1)用`Lagrange`插值计算$\sin(\pi/8)$的近似值；
   (2)在同一图形中画出$y=\sin x$及`Lagrange`插值多项式的图形。

   ```matlab
   % (1)lagrange函数代码同书，以下不再重复
   x0=[0:pi/4:2*pi];
   y0=[0,0.707,1,0.707,0,-0.707,-1,-0.707,0];
   ex6_1(x0,y0,pi/8)
   % 输出
   ans =
       0.3834
   % (2)
   z=0:pi/100:2*pi;
   y=ex6_1(x0,y0,z);
   plot(z,y,'-b');
   hold on;
   plot(z,sin(z),'-.r');
   legend('lagrange','sin x');
   ```
   
   ![ex6_1](D:\undergraduate\matlab\self-answers\ex6_1.png)

2. 对于题1，在$[0,2\pi]$间插入$20$个等距节点，用线性插值逼近$\sin x$，并在同一图形中画出$y=\sin x$及线性插值函数的图形。

   ```matlab
   x=0:2*pi/21:2*pi;
   y=interp1(x0,y0,x,'linear');
   plot(x,y,'-b');
   hold on;
   plot(x,sin(x),'-.r');
   legend('lagrange-linear','sin x');
   ```

3. 设有数据如下：

   | $x$  | $0$  | $\pi/4$ | $\pi/2$ | $3\pi/4$ | $\pi$ | $5\pi/4$ | $3\pi/2$ | $7\pi/4$ | $2\pi$ |
   | :--: | :--: | :-----: | :-----: | :------: | :---: | :------: | :------: | :------: | :----: |
   | $y$  | $0$  | $0.707$ |   $1$   | $0.707$  |  $0$  | $-0.707$ |   $-1$   | $-0.707$ |  $0$   |
   | $y'$  | $1$  | $0.707$ |   $0$   | $-0.707$  |  $-1$  | $-0.707$ |   $0$   | $0.707$ |  $1$   |

   用`Hermite`插值计算$\sin(\pi/8)$的近似值，并在同一图形中画出$y=\sin x$及`Hermite`插值多项式的图形。

   ```matlab
   % sin(pi/8)的近似值
   x0=[0:pi/4:2*pi];
   y0=[0,0.707,1,0.707,0,-0.707,-1,-0.707,0];
   y1=[1,0.707,0,-0.707,-1,-0.707,0,0.707,1];
   z=ex6_3(x0,y0,y1,pi/8)
   % 输出
   z =
       0.3829
   % 图形
   x=0:pi/100:2*pi;
   y=ex6_3(x0,y0,y1,x);
   plot(x,y,'-b');
   hold on;
   plot(x,sin(x),'-.r');
   legend('hermite','sin x');
   ```

4. 设有实验数据如下：

   | $x_i$  | $0.2$  | $0.35$ | $0.5$ | $0.75$ | $1$ | $1.23$ | $1.36$ | $1.52$ | $1.8$ |
   | :--: | :--: | :-----: | :-----: | :------: | :---: | :------: | :------: | :------: | :----: |
   | $y_i$  | $1.224$  | $1.4194$ |   $1.6487$   |  $1.383$   | $0.7817$  |  $0.0788$  | $-0.3962$ |   $-1.0722$   | $-2.5496$ |

   (1)试求一多项式$p_1(x)=ax^3+bx^2+cx+d$使得$\displaystyle \sum\limits_{i=1}^{n}(y_i-p(x_i))^2$最小，并同一图形中画出这些点及所求得的多项式$p_1(x)$。
   (2)经验表明：$x$与$y$的关系呈现$p_2(x)=ax^3+cx+d$，试求多项式$p_2(x)$，并在同一图形中画出$(x_i,y_i)$及多项式$p_2(x)$的图形。

   ```matlab
   % (1)
   x0=[0.2,0.35,0.5,0.75,1,1.23,1.36,1.52,1.8];
   y0=[1.224,1.4194,1.6487,1.383,0.7817,0.0788,-0.3962,-1.0722,-2.5496];
   p1=polyfit(x0,y0,3);
   x1=[0.2:0.01:1.8];
   y1=p1(1)*x1.^3+p1(2)*x1.^2+p1(3)*x1+p1(4);
   plot(x0,y0,'ob');
   hold on;
   plot(x1,y1,'-r');
   legend('points','p_1(x)');
   title('(1)');
   % (2)利用X\y0'直接解得a、c、d
   X=[(x0.^3)',(x0)',ones(9,1)];
   acd=X\(y0)';
   x1=[0.2:0.01:1.8];
   y1=acd(1)*x1.^3+acd(2)*x1+acd(3);
   plot(x0,y0,'ob',x1,y1,'-r');
   legend('points','p_2(x)');
   title('(2)');
   ```

5. 设有数据$(1,2)、(2,3)、(3,5)、(4,6)、(1.5,2)、(5,9)、(6.1,4)$，据此数据求一个$4$次多项式进行最小二乘拟合。

   ```matlab
   x0=[1,2,3,4,1.5,5,6.1];
   y0=[2,3,5,6,2,9,4];
   p=polyfit(x0,y0,4)
   % 输出
   p =
      -0.1144    1.2934   -4.7907    8.2038   -2.8218
   ```

6. 设有函数$y=b_0+b_1x_1+b_2\sin x_2+b_3(\log x_3)x_4$，其中$x=(x_1,x_2,x_3,x_4)$是自变量，$b_0,b_1,b_2,b_3$是参数，实际观察数如下：

   | $x_1$  |  $x_2$  | $x_3$ | $x_4$ |  $y$  |
   | :----: | :-----: | :---: | :---: | :---: |
   |  $1$   |   $2$   |  $3$  |  $1$  |  $3$  |
   |  $0$   |   $7$   |  $2$  |  $2$  | $0.8$ |
   |  $-1$  |  $-2$   |  $1$  |  $4$  | $2.8$ |
   | $0.5$  |  $\pi$  | $\pi$ |  $2$  | $1.5$ |
   | $-0.4$ | $\pi/2$ |  $1$  |  $2$  | $2.3$ |

   求出$b_0,b_1,b_2,b_3$的最小二乘估计值。

   ```matlab
% 函数式文件
   function y=ex6_6(b,x)
   y=b(1)+b(2).*x(:,1)+b(3).*sin(x(:,2))+b(4).*(log(x(:,3))).*x(:,4);
   % 命令行窗口
   xdata=[[1,0,-1,0.5,-0.4]',[2,7,-2,pi,pi/2]',[3,2,1,pi,1]',[1,2,4,2,2]'];
   ydata=[3;0.8;2.8;1.5;2.3];
   b=[1,1,1,1];	% 也可使用其他初始值
   [beta,R]=nlinfit(xdata,ydata,'ex6_6',b)
   
   [beta,resnorm]=lsqcurvefit(@ex6_6,b,xdata,ydata)
   % 输出，如果设置format long会导致两种函数出来的beta结果不一致
   beta =
      3.7815    1.8066   -0.9685   -1.4836
   R =
      -0.0776
      -0.2885
      -0.0555
       0.2119
       0.2096
   
   beta =
       3.7815    1.8066   -0.9685   -1.4836
   resnorm =
       0.1812
   ```

